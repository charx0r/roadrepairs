<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8 />
        <title>ROAD Repairs</title>

        <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
        <script src='http://api.tiles.mapbox.com/mapbox.js/v1.5.0/mapbox.js'></script>
        <link href='http://api.tiles.mapbox.com/mapbox.js/v1.5.0/mapbox.css' rel='stylesheet' />

        <style>
            body { margin:0; padding:0; }
            #map { position:absolute; top:0; bottom:0; width:100%; }
        </style>
    </head>
    <body>
        <style>
            .popup {
                text-align: center;
            }
            .popup .slideshow {
                width: 100%;
            }
            .popup .slideshow .image {
                display: none;
            }
            .popup .slideshow .active {
                display: block;
            }
            .popup .slideshow img {
                width: 100%;
            }
            .popup .slideshow .caption {
                background: #eee;
                padding: 8px;
                text-align:left;
                font-size:12px;
            }
            .popup .cycle {
                height: 30px;
                margin-top: 5px;
                padding-top: 5px;
            }
            .popup .cycle a.prev {
                float: left;
            }
            .popup .cycle a.next {
                float: right;
            }
        </style>
        <div id='map'></div>
        <script>
            var map = L.mapbox.map('map', 'charan.ggg0g4l1')
                    .setView([17.40951, 78.43351], 17);
            map.addControl(L.mapbox.geocoderControl('charan.ggg0g4l1', {
                keepOpen: true
            }));

            var geoJson = {
                "type": "FeatureCollection",
                "crs": {"type": "name", "properties": {"name": "urn:ogc:def:crs:OGC:1.3:CRS84"}},
                "features": [
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Hanuman temple,MCH park", 'images': [
                                ['rr1.jpg', "<b>Nature of Work</b>: Maintainence of footpath from 1/12 junction to opp IT quarters, Road No.12, Banjara Hills, DIV.10 <br /><b>File No</b>. 498/Div-9.<br /><b>Santion Amount</b>: 43,380<br /> <b>Budget Head</b>: 99928012305002<br /> <b>Sanction Authority</b>: Zonal Commissioner"],
                            ]}, "geometry": {"type": "Point", "coordinates": [78.436952456024116, 17.409225240202474]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Mithila nagar colony", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4367796, 17.4081332]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Plot no.6", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4359148, 17.4081945]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Plot no.12", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.435104699999982, 17.4082489]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "new royal tradders\/8-2-686\/13", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4353802, 17.4091017]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "H.no.8-2-684\/102\/70", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4342393, 17.409095399999988]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "s.no.8-2-684\/102\/54 \/ Sony vcd library", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.433950023892535, 17.409075581331038]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "8-2-684\/102\/44\/1", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.433811852264625, 17.409082707946723]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "diamond mutton & chicken shop\/8-2-684\/100\/10\/A", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.433634469769274, 17.40908448960062]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Shiva Hanuman temple", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.43336932961833, 17.409102306138486]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "8-2-684\/102\/50", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.43392014894593, 17.408676490407949]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "8-2-684\/102\/22", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.433675542396429, 17.408609352161349]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "10-5-391\/55\/45\/A", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4334216, 17.407327599999988]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "10-5-391\/55\/1\/54", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4336526, 17.4071326]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "10-5-391\/54\/42\/C", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.433942061108894, 17.4082111042175]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "10-5-391\/55\/1\/76\/4", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.433787578870493, 17.408239983712782]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "8-2-684\/10\/51\/A", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4340008, 17.4084274]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "New Oxford School", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4345747, 17.408274]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Shaheen School", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4341832, 17.4069892]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Chilla point circle", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4340941, 17.4067967]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "8-2-693\/2\/31", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.436750099999983, 17.407653399999983]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "8-2-693\/2\/28", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.436349430202796, 17.407662462076917]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Plot no.25(h.no.318)", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.435923299999985, 17.407672099999989]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Plot no.59", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.435623020901176, 17.407678759286938]}},
                    {"type": "Feature", "properties": {"TYPE_1": null, "TYPE_2": null, title: "Naivedya ,36\/B, Mithila nagar", 'images': [
                                ['rr1.jpg', 'Work Details come here']]}, "geometry": {"type": "Point", "coordinates": [78.4366276, 17.406695399999986]}}
                ]
            };

            map.markerLayer.setGeoJSON(geoJson);
            // Add custom popup html to each marker
            map.markerLayer.on('layeradd', function(e) {
                var marker = e.layer;
                var feature = marker.feature;
                var images = feature.properties.images
                var slideshowContent = '';

                for (var i = 0; i < images.length; i++) {
                    var img = images[i];

                    slideshowContent += '<div class="image' + (i === 0 ? ' active' : '') + '">' +
                            '<img src="' + img[0] + '" />' +
                            '<div class="caption">' + img[1] + '</div>' +
                            '</div>';
                }

                // Create custom popup content
                var popupContent = '<div id="' + feature.properties.id + '" class="popup">' +
                        '<h2>' + feature.properties.title + '</h2>' +
                        '<div class="slideshow">' +
                        slideshowContent +
                        '</div>' +
                        '</div>';

                // http://leafletjs.com/reference.html#popup
                marker.bindPopup(popupContent, {
                    closeButton: false,
                    minWidth: 420
                });
            });

            // Add features to the map
            map.markerLayer.setGeoJSON(geoJson);


        </script>
    </body>
</html>
